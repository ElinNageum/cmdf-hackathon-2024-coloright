{% extends 'base.html' %}

{% block content %}

<div class="header">
    <h3>Testing page</h3>
</div>

<div id="testContainer">
    <!-- Single img element for displaying images -->
    <img src="/static/color_3.jpg" alt="Ishihara Test Image" id="ishiharaImage">
    <!-- <img src="/static/color_12.jpg" alt="Ishihara Test Image" id="ishiharaImage">
    <img src="/static/color_29.jpg" alt="Ishihara Test Image" id="ishiharaImage">
    <img src="/static/color_74.jpg" alt="Ishihara Test Image" id="ishiharaImage"> -->
    <input type="text" id="userAnswer" placeholder="Enter your answer here">
    <button onclick="submitAnswer()">Submit</button>
    <div id="feedback"></div>
    <button onclick="nextImage()">Next</button>
</div>

<script>
    let currentImageIndex = 0;
    const images1 = [
        "{{ url_for('static', filename='images/color_7.jpg') }}",
        "{{ url_for('static', filename='images/color_12.jpg') }}",
        "{{ url_for('static', filename='images/color_29.jpg') }}",
        "{{ url_for('static', filename='images/color_74.jpg') }}",
        // Add more image paths here
    ];
    const answerKey = [
        { number: '3', description: 'Description for image color_3' },
        { number: '12', description: 'Description for image color_12' },
        { number: '29', description: 'Description for image color_29' },
        { number: '74', description: 'Description for image color_74' },
        // Add more answers with descriptions here
    ];

    window.onload = () => {
        loadImage();
    };

    function loadImage() {
        const imgElement = document.getElementById('ishiharaImage');
        imgElement.src = images[currentImageIndex];
        // Optionally, update alt text for accessibility
        imgElement.alt = "Ishihara Test Image " + (currentImageIndex + 1);
    }

    function submitAnswer() {
        const userAnswer = document.getElementById('userAnswer').value;
        const feedbackElement = document.getElementById('feedback');
        if (userAnswer === answerKey[currentImageIndex].number) {
            feedbackElement.textContent = 'Correct! ' + answerKey[currentImageIndex].description;
        } else {
            feedbackElement.textContent = 'Wrong. The correct answer is ' + answerKey[currentImageIndex].number + '. ' + answerKey[currentImageIndex].description;
        }
    }

    var i = 0, images = ["static/color_7.jpg",
                         "static/color_12.jpg",
                         "static/color_29.jpg",
                         "static/color_74.jpg"] 

    function nextImage() {
         if (currentImageIndex === 'next')
        { 
            i++;
            if (i === images.length) { i = images.length - 1}
        } else {
            i--;
            if(i > 0) { i = 0; }
        }

         document.getElementById('ishiharaImage').src = images[i];

        currentImageIndex++;
        if (currentImageIndex >= images.length) {
            alert('You have reached the end of the test.');
            currentImageIndex = 0; // Optionally reset the test or handle the end differently
        }
        loadImage();
        document.getElementById('userAnswer').value = ''; // Clear the input box
        document.getElementById('feedback').textContent = ''; // Clear the feedback
    }
</script>

<!-- </head>
<body>

    <div>
        <img src="../images/color_3.jpg" id="ishiharaImage" alt="" width="400" height="200">
        <button onclick="nextImage('prev');"><</button>
        <button onclick="nextImage('next');">></button>"
        <input type="text" id="userAnswer" placeholder="Enter your answer here">
        <button onclick="submitAnswer()">Submit</button>
        <div id="feedback"></div>
    </div>
</body> -->

{% endblock %}
